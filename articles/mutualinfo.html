<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Associations among variates and mutual information • inferno</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Associations among variates and mutual information">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inferno</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/inferno_start.html">Bayesian nonparametric inference with inferno</a></li>
    <li><a class="dropdown-item" href="../articles/mutualinfo.html">Associations among variates and mutual information</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pglpm/inferno/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Associations among variates and mutual information</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pglpm/inferno/blob/main/vignettes/mutualinfo.Rmd" class="external-link"><code>vignettes/mutualinfo.Rmd</code></a></small>
      <div class="d-none name"><code>mutualinfo.Rmd</code></div>
    </div>

    
    
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex">\newcommand{\mo}{\mathrel{\!=\!}}</annotation></semantics></math></p>
<p>This vignette gives an introduction and guide to the visual and
quantitative capabilities and functions of the
<strong><em>inferno</em></strong> package, for the study of
associations, correlations, and links.</p>
<p>See the <code><a href="../articles/inferno_start.html">vignette('inferno_start')</a></code> for an introduction to
the package. The present vignette continues with the same example and
dataset.</p>
<p><br></p>
<div class="section level2">
<h2 id="probabilities-and-associations">Probabilities and associations<a class="anchor" aria-label="anchor" href="#probabilities-and-associations"></a>
</h2>
<p>The <code><a href="../articles/inferno_start.html">vignette('inferno_start')</a></code> focuses on the
<code><a href="https://rdrr.io/r/datasets/penguins.html" class="external-link">datasets::penguins</a></code> dataset, and shows how to calculate
probabilities of single and joint variates from that dataset; also
probabilities conditional on given variates. These probabilities refers
to a <em>new unit</em>; for example:</p>
<ul>
<li>If we find that <span class="math inline">$\mathrm{Pr}(\text{species}\mo \text{Adelie}) =
44\%$</span>, then there’s a 44% probability that the next penguin we
sample (from the same population) is of the <em>Adélie</em>
species.</li>
<li>If we find that <span class="math inline">$\mathrm{Pr}(\text{species}\mo \text{Gentoo}
\,\vert\, \text{island} \mo \text{Biscoe}) = 1\%$</span>, then if we
have a new penguin, and we know it is from Biscoe island, there’s a 1%
probability that it is of the <em>Gentoo</em> species.</li>
</ul>
<p>And these probabilities can also be interpreted as “estimates” of the
corresponding <em>whole-population</em> frequencies.</p>
<p><br>
Joint probabilities and conditional probabilities already give a
quantitative measure of the “association”, “correlation”, or “link”
between several variates. They tell us for instance that it can be rare
or very common to observe particular pairs of values together; or that
it is rare or very common to observe values of some variates in cases
where other variates have particular values. In the example above, it’s
rare to observe the value <code>'Gentoo'</code> of the variate
<code>species</code> in penguins that have value <code>'Biscoe'</code>
for the variate <code>island</code>. These associations are extremely
important in fields like medicine, where we may want to diagnose or
prognose a disease from possible symptoms, or we try to understand which
clinical conditions are associated with the disease, possibly because of
underlying biological reasons.</p>
<p>We shall now explore first some visual ways to examine associations
with <strong><em>inferno</em></strong>, and then some more precise
quantitative ways, which also apply when visualization becomes
impossible.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="generating-and-plotting-new-samples">Generating and plotting <em>new</em> samples<a class="anchor" aria-label="anchor" href="#generating-and-plotting-new-samples"></a>
</h2>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>Let’s load the <strong><em>inferno</em></strong> package, if we
haven’t already done so, and set a random seed to ensure
reproducibility:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/pglpm/inferno/" class="external-link">'inferno'</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>As in the <code><a href="../articles/inferno_start.html">vignette('inferno_start')</a></code>, we work with a
specific population of penguins, of which we have 344 sample data stored
in the [<code><a href="https://rdrr.io/r/datasets/penguins.html" class="external-link">datasets::penguins</a></code>] dataset, included in R version
4.5.0 and above. For your convenience you can download the shuffled
dataset as the CSV file <a href="https://github.com/pglpm/inferno/raw/main/development/downloads/penguin_data.csv" class="external-link"><code>penguin_data.csv</code></a>,
then load it with the <code><a href="../reference/inferno.data.html">read.csvi()</a></code> function as follows:</p>
<p>We assume that we have already learned all predictive information
from this dataset by means of the <strong><em>inferno</em></strong>
function <code><a href="../reference/learn.html">learn()</a></code>. This information is stored in an object
stored in the compressed file <code>learnt.rds</code> within the output
directory that was specified in the <code><a href="../reference/learn.html">learn()</a></code> function. For
your convenience the object produced by the computation above can be
downloaded as the file <a href="https://github.com/pglpm/inferno/raw/main/development/downloads/learntall.rds" class="external-link"><code>learntall.rds</code></a>.
Once you have downloaded it in your working directory you can just
invoke</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">learnt</span> <span class="op">&lt;-</span> <span class="st">'learntall.rds'</span></span></code></pre></div>
<p>which produces an object <code>learnt</code> (just a character
string, in this case) which shall be used in the following analysis.</p>
</div>
<div class="section level3">
<h3 id="newsamples">Generating new samples<a class="anchor" aria-label="anchor" href="#newsamples"></a>
</h3>
<p>Let’s focus on the <code>island</code> and <code>species</code>
variates. Each variate has three possible values;
<strong><em>inferno</em></strong>’s utility function
<code><a href="../reference/vrtgrid.html">vrtgrid()</a></code> allows us to create a vector of all possible
values of each variate, which are stored in the metadata of the
<code>learnt</code> object:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">islandvalues</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vrtgrid.html">vrtgrid</a></span><span class="op">(</span>vrt <span class="op">=</span> <span class="st">'island'</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span><span class="co"># [1] "Biscoe"    "Dream"     "Torgersen"</span></span>
<span></span>
<span><span class="va">speciesvalues</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vrtgrid.html">vrtgrid</a></span><span class="op">(</span>vrt <span class="op">=</span> <span class="st">'species'</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span><span class="co"># [1] "Adelie"    "Chinstrap" "Gentoo"</span></span></code></pre></div>
<p>The <code><a href="../reference/flexiplot.html">flexiplot()</a></code> function allows us to display the
<code>island</code> and <code>species</code> variates against each
other, for all <em>sample</em> data, as a scatter plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">penguin</span><span class="op">$</span><span class="va">island</span>, y <span class="op">=</span> <span class="va">penguin</span><span class="op">$</span><span class="va">species</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'p'</span>, xlab <span class="op">=</span> <span class="st">'island'</span>, ylab <span class="op">=</span> <span class="st">'species'</span>,</span>
<span>    xdomain <span class="op">=</span> <span class="va">islandvalues</span>, ydomain <span class="op">=</span> <span class="va">speciesvalues</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/vissample-1.png" alt="**Scatter plot of sample data**" width="100%"><p class="caption">
<strong>Scatter plot of sample data</strong>
</p>
</div>
<p>Note how <code><a href="../reference/flexiplot.html">flexiplot()</a></code> automatically add a slight jitter
(by means of <code><a href="https://rdrr.io/r/base/jitter.html" class="external-link">base::jitter()</a></code>) to the discrete variates, so
that the points don’t just overlap rendering the plot otherwise
incomprehensible.</p>
<p>We immediately see some basic features of these variates in this
sample. For example:</p>
<ul>
<li>the most common occurrence is the pair
<code>island = 'Biscoe'</code> and <code>species = 'Gentoo'</code>;</li>
<li>the pair <code>island = 'Torgersen'</code> and
<code>species = 'Chinstrap'</code> does <em>not</em> occur at all.</li>
</ul>
<p>These are only features of this specific data sample, however. Can we
generalize them to the <em>whole</em> population? Intuitively it seems
probable that the <code>'Biscoe'</code>-<code>'Gentoo'</code> pair can
indeed be the commonest occurrence in the whole population as well. But
we can’t say for sure that the
<code>'Torgersen'</code>-<code>'Chinstrap'</code> pair never occurs in
the whole population: our sample included only 344 penguins, so what we
can say is that this pair roughly occurs less frequently than once every
344 penguins. In fact, a calculation with the <code><a href="../reference/Pr.html">Pr()</a></code> function
shows that its probability is around 0.3%:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pr.html">Pr</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>island <span class="op">=</span> <span class="st">'Torgersen'</span>, species <span class="op">=</span> <span class="st">'Chinstrap'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">prob</span><span class="op">$</span><span class="va">values</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#                      X</span></span>
<span><span class="co"># Y                      [,1]</span></span>
<span><span class="co">#   Torgersen,Chinstrap 0.003</span></span></code></pre></div>
<p><br>
This example shows the limitations of using sample data for visualizing
features of the <em>whole</em> population. How would a scatter plot
analogous to the one above look like, for the <em>whole</em> population
of for a much larger sample?</p>
<p>The <strong><em>inferno</em></strong> package offers the function
<code><a href="../reference/rPr.html">rPr()</a></code> to generate a data.frame of fictitious samples from
the estimated frequencies of the whole population. These samples can be
used for different purposes, for instance to produce a scatter plot. The
main arguments of <code><a href="../reference/rPr.html">rPr()</a></code> are:</p>
<ul>
<li>
<code>n</code>: a positive integer, the number of samples to
generate.</li>
<li>
<code>Ynames</code>: vector of variate names; samples are generates
for these variates jointly.</li>
<li>
<code>X</code>: data frame of variate values to restrict the
sampling to specific subpopulations.</li>
<li>
<code>learnt</code>: the object that points to the computation made
with the <code><a href="../reference/learn.html">learn()</a></code> function.</li>
</ul>
<p>Let’s first generate 5 samples from the estimated whole population of
penguins, as an example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'island'</span>, <span class="st">'species'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#        island   species</span></span>
<span><span class="co"># 644_1  Biscoe    Gentoo</span></span>
<span><span class="co"># 996_1  Biscoe    Gentoo</span></span>
<span><span class="co"># 1228_1 Biscoe    Adelie</span></span>
<span><span class="co"># 2230_1  Dream Chinstrap</span></span>
<span><span class="co"># 3083_1  Dream Chinstrap</span></span></code></pre></div>
<p>The rows of the resulting data frame are named according to the Monte
Carlo samples used from the <code>learnt</code> object; they can be
useful for peculiar studies but we can completely ignore them in the
present case.</p>
<p>Now let’s generate 2000 samples, and then plot them in a scatter
plot:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'island'</span>, <span class="st">'species'</span><span class="op">)</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">island</span>, y <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">species</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'p'</span>, xlab <span class="op">=</span> <span class="st">'island'</span>, ylab <span class="op">=</span> <span class="st">'species'</span>,</span>
<span>    xdomain <span class="op">=</span> <span class="va">islandvalues</span>, ydomain <span class="op">=</span> <span class="va">speciesvalues</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/gensamplesplot-1.png" alt="**Scatter plot for *whole* population**" width="100%"><p class="caption">
<strong>Scatter plot for <em>whole</em> population</strong>
</p>
</div>
<p>The scatter plot above correctly reflects the <em>estimated</em>
features of the <em>whole</em> population.</p>
</div>
<div class="section level3">
<h3 id="example-with-a-continuous-and-a-discrete-variate">Example with a continuous and a discrete variate<a class="anchor" aria-label="anchor" href="#example-with-a-continuous-and-a-discrete-variate"></a>
</h3>
<p>The sampling and plotting from the previous example is easily
extended to any other pair or variates, or even to pairs of sets of
variates. Let us visualize for instance the joint probability of
<code>body_mass</code> and <code>species</code> with another scatter
plot.</p>
<p>We generate 2000 whole-population samples of the two variates with
<code><a href="../reference/rPr.html">rPr()</a></code>, and then scatter-plot them with
<code><a href="../reference/flexiplot.html">flexiplot()</a></code>. First we select an appropriate plot range for
the continuous variate <code>body_mass</code> by means of
<strong><em>inferno</em></strong>’s utility function
<code><a href="../reference/vrtgrid.html">vrtgrid()</a></code>: this function chooses an optimal value based on,
and including, the range of data previously observed:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body_massrange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="../reference/vrtgrid.html">vrtgrid</a></span><span class="op">(</span>vrt <span class="op">=</span> <span class="st">'body_mass'</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'body_mass'</span>, <span class="st">'species'</span><span class="op">)</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">body_mass</span>, y <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">species</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'p'</span>, xlab <span class="op">=</span> <span class="st">'body_mass / g'</span>, ylab <span class="op">=</span> <span class="st">'species'</span>,</span>
<span>    xlim <span class="op">=</span> <span class="va">body_massrange</span>, ydomain <span class="op">=</span> <span class="va">speciesvalues</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/gensamplesplotbodymassspecies-1.png" alt="**Scatter plot for body mass and species**" width="100%"><p class="caption">
<strong>Scatter plot for body mass and species</strong>
</p>
</div>
<p>Note again how <code><a href="../reference/flexiplot.html">flexiplot()</a></code> automatically add a jitter to
the discrete variate <code>species</code>, but not to the continuous
<code>body_mass</code>.</p>
<p>From the plot we see that there is an association between the Adélie
and Chinstrap species and lighter body mass, around 3500 g; and between
the Gentoo species and heavier body mass, around 5000 g. Incidentally,
this reflects the probability plot at the end of the
<code><a href="../articles/inferno_start.html">vignette('inferno_start')</a></code>.</p>
</div>
<div class="section level3">
<h3 id="samples-and-plots-for-different-subpopulations">Samples and plots for different subpopulations<a class="anchor" aria-label="anchor" href="#samples-and-plots-for-different-subpopulations"></a>
</h3>
<p>In a completely analogous way we can visually assess the association
of two continuous variates, such as body mass and bill length
(<code>bill_len</code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bill_lenrange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="../reference/vrtgrid.html">vrtgrid</a></span><span class="op">(</span>vrt <span class="op">=</span> <span class="st">'bill_len'</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'body_mass'</span>, <span class="st">'bill_len'</span><span class="op">)</span>, learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">body_mass</span>, y <span class="op">=</span> <span class="va">samples</span><span class="op">$</span><span class="va">bill_len</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'p'</span>, xlab <span class="op">=</span> <span class="st">'body_mass / g'</span>, ylab <span class="op">=</span> <span class="st">'bill_len / mm'</span>,</span>
<span>    xlim <span class="op">=</span> <span class="va">body_massrange</span>, ylim <span class="op">=</span> <span class="va">bill_lenrange</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/gensamplesplotbodybilllen-1.png" alt="**Scatter plot of body mass and bill length**" width="100%"><p class="caption">
<strong>Scatter plot of body mass and bill length</strong>
</p>
</div>
<p>The scatter plot shows that there is a partly linear relationship
between body mass and bill length; but there’s a sort of additional
cluster around 4000 g for body mass and 45 mm for bill length.</p>
<p>This observation leads to another interesting question: is the
association between <code>body_mass</code> and <code>bill_len</code>
different for different species? Perhaps the additional cluster is
characteristic of one species only. We are therefore interested in
studying this association for different
<strong>subpopulations</strong>.</p>
<p>Subpopulation sampling and plots can also be easily done with the
<code><a href="../reference/rPr.html">rPr()</a></code> and <code><a href="../reference/flexiplot.html">flexiplot()</a></code> functions. In the
<code><a href="../reference/rPr.html">rPr()</a></code> function we can specify the requested subpopulation
via the <code>X</code> argument, analogously to the <code><a href="../reference/Pr.html">Pr()</a></code>
function.</p>
<p>Let’s generate sets of samples separately for the species
<code>'Adelie'</code>, <code>'Chinstrap'</code>,
<code>'Gentoo'</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samplesAdelie</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'body_mass'</span>, <span class="st">'bill_len'</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">'Adelie'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samplesChinstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'body_mass'</span>, <span class="st">'bill_len'</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">'Chinstrap'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samplesGentoo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rPr.html">rPr</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    Ynames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'body_mass'</span>, <span class="st">'bill_len'</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">'Gentoo'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span><span class="op">)</span></span></code></pre></div>
<p>Now we plot these samples together with <code><a href="../reference/flexiplot.html">flexiplot()</a></code>,
choosing different colours and shapes for the three subpopulations. We
also use the <code>alpha.f</code> argument to make sure that the plot
points don’t completely cover one another:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">samplesAdelie</span><span class="op">$</span><span class="va">body_mass</span>,</span>
<span>        <span class="va">samplesChinstrap</span><span class="op">$</span><span class="va">body_mass</span>,</span>
<span>        <span class="va">samplesGentoo</span><span class="op">$</span><span class="va">body_mass</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">samplesAdelie</span><span class="op">$</span><span class="va">bill_len</span>,</span>
<span>        <span class="va">samplesChinstrap</span><span class="op">$</span><span class="va">bill_len</span>,</span>
<span>        <span class="va">samplesGentoo</span><span class="op">$</span><span class="va">bill_len</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'p'</span>, xlab <span class="op">=</span> <span class="st">'body_mass / g'</span>, ylab <span class="op">=</span> <span class="st">'bill_len / mm'</span>,</span>
<span>    xlim <span class="op">=</span> <span class="va">body_massrange</span>, ylim <span class="op">=</span> <span class="va">bill_lenrange</span>,</span>
<span>    pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, alpha.f <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'top'</span>, <span class="va">speciesvalues</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>    horiz <span class="op">=</span> <span class="cn">TRUE</span>, bty <span class="op">=</span> <span class="st">'n'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/plotbodybilllen3-1.png" alt="**Scatter plot for species subpopulations**" width="100%"><p class="caption">
<strong>Scatter plot for species subpopulations</strong>
</p>
</div>
<p>The plot above shows quite clearly that the
<code>body_mass</code>-<code>bill_len</code> association is indeed
different for each species. The roughly linear relationship that we
thought we saw earlier was partially spurious, coming from the
combination of associations for Adélie and Gentoo penguins.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="quantifying-associations-and-correlations-mutual-information">Quantifying associations and correlations: mutual information<a class="anchor" aria-label="anchor" href="#quantifying-associations-and-correlations-mutual-information"></a>
</h2>
<div class="section level3">
<h3 id="pearson-correlation-coefficient-and-its-limitations">Pearson correlation coefficient and its limitations<a class="anchor" aria-label="anchor" href="#pearson-correlation-coefficient-and-its-limitations"></a>
</h3>
<p>Plots like the ones above allow us to explore in a qualitative or
semi-quantitative way the associations and correlations between two or
three different variates and for different subpopulations. But we would
like to <em>quantify</em> associations in a more precise way. And
visualization may become impossible when we want to study the
association between complex sets of joint variates.</p>
<p>One very common and quite abused measure of “association” is the <a href="https://mathworld.wolfram.com/CorrelationCoefficient.html" class="external-link">Pearson
correlation coefficient</a>, usually denoted
“<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>”.
This measure is extremely limited, however. It is essentially <a href="https://doi.org/10.1080/01621459.1954.10501231" class="external-link">based on the
assumption that all variates involved have a joint Gaussian
distribution</a>. As a consequence, it is a measure of <em>linear</em>
association, rather than general association.</p>
<p>For instance, if the distribution of two continuous variates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>
lies in a semicircle, then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>
is actually a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>,
and is therefore perfectly associated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>:
if we know
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>,
then we can exactly predict the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>.
Yet the Pearson correlation coefficient between the two variates is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
in this case, simply because the functional dependence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>
on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
is not linear. Here is an example plot and value:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">129</span><span class="op">)</span> <span class="co">## Y1-values</span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Y1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co">## Y2-values: function of Y1</span></span>
<span></span>
<span><span class="co">## Calculate Pearson correlation coefficient</span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y1</span>, <span class="va">Y2</span>, method <span class="op">=</span> <span class="st">'pearson'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="co"># [1] 0</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Y1</span>, y <span class="op">=</span> <span class="va">Y2</span>, type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Pearson correlation: '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">r</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/pearsonplot-1.png" alt="**Perfect correlation from $Y_1$ to $Y_2$, with zero Pearson correlation coefficient**" width="100%"><p class="caption">
<strong>Perfect correlation from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>,
with zero Pearson correlation coefficient</strong>
</p>
</div>
<p>Similar limitations of the Pearson correlation coefficient are
demonstrated by the “<a href="https://doi.org/10.2307/2682899" class="external-link">Anscombe
quartet</a>” of datasets.</p>
<p>The Pearson correlation coefficient, moreover, cannot be used in the
case of nominal variates, because they cannot be sorted in any
meaningful order. Yet there can be clear associations among nominal
variates, as <a href="#newsamples">was shown for the island and species
variates</a>.</p>
</div>
<div class="section level3">
<h3 id="mutual-information">Mutual information<a class="anchor" aria-label="anchor" href="#mutual-information"></a>
</h3>
<p>Is there a measure of association that enjoys at least the following
three properties?:</p>
<ul>
<li>It quantifies general associations, not just linearity.</li>
<li>It does not make any assumptions (such as Gaussianity) about the
distribution of variates.</li>
<li>It can be used for any kind of variates.</li>
</ul>
<p>The answer is <em>yes, there is</em>! It is called the <strong>mutual
information</strong> or <a href="https://www.electropedia.org/iev/iev.nsf/display?openform&amp;ievref=171-07-27" class="external-link"><strong>mean
transinformation content</strong></a> between variates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>.
It has the following important properties:</p>
<ul>
<li><p>If there is no association whatever between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>,
in the sense that knowledge of one never changes our probabilities about
the other, then the mutual information between them is zero. Vice versa,
if the mutual information is zero, then there is no association of any
kind between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>.</p></li>
<li><p>It can be defined for a pair of variates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>1</mn></msub><annotation encoding="application/x-tex">Y_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mn>2</mn></msub><annotation encoding="application/x-tex">Y_2</annotation></semantics></math>
of any kind – continuous, nominal, binary, images, audio signals, and so
on.</p></li>
<li><p>It is defined for any probability distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Y</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{Pr}(Y_1, Y_2)</annotation></semantics></math>
for the two variates, without assumptions such as Gaussian
shapes.</p></li>
</ul>
<p>Mutual information is always positive or zero, and can be defined in
several mathematically equivalent ways, such as the following:</p>
<p><span class="math display">$$
\sum_{y_1, y_2} \mathrm{Pr}(Y_1 \mo y_1, Y_2 \mo y_2) \,
\log_2 \frac{
\mathrm{Pr}(Y_1 \mo y_1, Y_2 \mo y_2)
}{
\mathrm{Pr}(Y_1 \mo y_1) \cdot \mathrm{Pr}(Y_2 \mo y_2)
} \; \mathrm{Sh}
$$</span></p>
<p>with integrals replacing the sums in the case of continuous variates.
It is measured in <em>shannons</em> (symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">S</mi><mi mathvariant="normal">h</mi></mrow><annotation encoding="application/x-tex">\mathrm{Sh}</annotation></semantics></math>),
or <em>hartleys</em> (symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">H</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\mathrm{Hart}</annotation></semantics></math>),
or <em>natural units</em> (symbol
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">n</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\mathrm{nat}</annotation></semantics></math>).
These units and other properties of the mutual information are <a href="https://archive.org/details/iso-standards-collection/BS%20EN%2080000-13-2008%20-%201%20Quantities%20and%20units" class="external-link">standardized
by the International Organization for Standardization (ISO) and the
International Electrotechnical Commission (IEC)</a>.</p>
<p>Mutual information is in fact a core quantity of communication theory
and information theory. The design and assessment of communication
channels depends crucially on it. This makes sense: the main requisite
of a communication channel is a strong association between two variates:
its input and output messages. You can find a brilliant introduction to
its meaning and uses in MacKay’s book, see <span id="references">references</span>.</p>
<p><br>
The <strong><em>inferno</em></strong> package provides the function
<code><a href="../reference/mutualinfo.html">mutualinfo()</a></code> to calculate the mutual information between
two variates or two sets of joint variates. Its main arguments are the
following:</p>
<ul>
<li>
<code>Y1names</code>, <code>Y2names</code>: two vectors of variate
names; the mutual information is calculated between these two sets.</li>
<li>
<code>X</code>: data frame of variate values to restrict the
calculation to specific subpopulations.</li>
<li>
<code>learnt</code>: the object that points to the computation made
with the <code><a href="../reference/learn.html">learn()</a></code> function.</li>
<li>Optionally, <code>unit</code>: the mutual information unit; default
“shannons” (Sh).</li>
<li>Optionally, <code>parallel</code> specifies how many cores we should
use for the computation.</li>
</ul>
<p>For example let’s calculate the mutual information between the
variates <code>island</code> and <code>species</code>, <a href="#newsamples">previously discussed and visualized</a>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MIislandspecies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mutualinfo.html">mutualinfo</a></span><span class="op">(</span></span>
<span>    Y1names <span class="op">=</span> <span class="st">'island'</span>, Y2names <span class="op">=</span> <span class="st">'species'</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fl">4</span> <span class="co">## let's use 4 cores</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Registered doParallelSNOW with 4 workers</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Closing connections to cores.</span></span></code></pre></div>
<p>The resulting object <code>MIislandspecies</code> is a list of
several quantities; the mutual information is given in the
<code>$MI</code> element, which includes the accuracy of the result:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MIislandspecies</span><span class="op">$</span><span class="va">MI</span></span>
<span><span class="co">#    value accuracy </span></span>
<span><span class="co"># 0.633996 0.015000</span></span></code></pre></div>
<p><br></p>
<p><em>(TO BE CONTINUED)</em></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendices<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ul>
<li>MacKay: <a href="https://www.inference.org.uk/itila/book.html" class="external-link"><em>Information
Theory, Inference, and Learning Algorithms</em></a> (2005).</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by PierGianLuca Porta Mana, Aurora Grefsrud, Håkon Mydland, Maksim Ohvrill, Simen Hesthamar Hauge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
