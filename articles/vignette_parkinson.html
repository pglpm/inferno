<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example of use: inferences for Parkinson's Disease • inferno</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example of use: inferences for Parkinson's Disease">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inferno</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/inferno_start.html">Bayesian nonparametric inference with inferno</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_mutualinfo.html">Associations of variates with mutual information</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_parkinson.html">Example of use: inferences for Parkinson's Disease</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pglpm/inferno/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example of use: inferences for Parkinson's Disease</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pglpm/inferno/blob/main/vignettes/vignette_parkinson.Rmd" class="external-link"><code>vignettes/vignette_parkinson.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_parkinson.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>Here is a toy example showing some kinds of results that can be
obtained with Bayesian nonparametric exchangeable inference. The example
involves inferences about some investigations on Parkinson’s Disease
described in the paper by <a href="https://doi.org/10.1016/j.cmet.2022.02.001" class="external-link">Brakedal &amp;
al. (2022)</a>, which generously and professionally shares its <a href="https://www.cell.com/cms/10.1016/j.cmet.2022.02.001/attachment/82e51142-50b8-4f84-a3e0-7c08d641a47b/mmc2.xlsx" class="external-link">data</a>.</p>
<p>The investigations in the cited paper involve 30 subjects, for each
of which various data are collected. Fifteen of these subjects belong to
a control group, the other 15 to the treatment group, denoted
<code>NR</code>. This group received a nicotinamide adenine dinucleotide
(NAD) replenishment therapy, via oral intake of nicotinamide riboside
(NR). In this toy example we do not follow or reproduce the paper’s
investigations, nor do we use all the variates observed. We limit
ourselves to 7 variates for each subject. Here is a list with a brief
description of each:</p>
<ul>
<li><p><strong>Treatment group</strong>: <em>Binary</em> variate with
values <code>Placebo</code> and <code>NR</code>.</p></li>
<li><p><strong>Sex</strong>: <em>Binary</em> variate with values
<code>Female</code> and <code>Male</code>.</p></li>
<li><p><strong>Age</strong>: <em>Integer</em> variate, or continuous but
<em>rounded</em> variate.</p></li>
<li><p><strong>Anamnestic loss of smell</strong>: <em>Binary</em>
variate with values <code>No</code> and <code>Yes</code>.</p></li>
<li><p><strong>History of REM sleep behaviour disorder</strong>:
<em>Binary</em> variate with values <code>No</code> and
<code>Yes</code>.</p></li>
<li><p><strong>MDS-UPDRS-III score at the first subject visit</strong>:
The <a href="https://www.movementdisorders.org/MDS-Files1/PDFs/Rating-Scales/MDS-UPDRS_English_FINAL.pdf" class="external-link">MDS-UPDRS-III</a>
(Movement Disorder Society’s Unified Parkinson’s Disease Rating Scale)
is one of a set of <em>ordinal</em> scales to assess a subject’s degree
of disability and monitor it over time. The scale III ranges from
<code>0</code> (no disability) to <code>132</code> (highest degree of
disability). Given that operations such as sum or average are performed
on these scales in the literature, the scales should be considered on an
<em>interval</em> kind rather than simply ordinal.</p></li>
<li><p><strong>Difference in MDS-UPDRS-III scores between second and
first visit</strong>: <em>Ordinal</em> variate, the difference of the
previous one between the subject’s second and first visit. Its range is
therefore from <code>-132</code> to <code>+132</code>, <em>negative</em>
values representing an <em>improvement</em>.</p></li>
</ul>
<p><br></p>
<p>We store the name of the datafile</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datafile</span> <span class="op">&lt;-</span> <span class="st">'toydata.csv'</span></span></code></pre></div>
<p>Here are the values for two subjects:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="5%">
<col width="2%">
<col width="18%">
<col width="28%">
<col width="21%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">TreatmentGroup</th>
<th align="left">Sex</th>
<th align="right">Age</th>
<th align="left">Anamnestic.Loss.of.smell</th>
<th align="left">History.of.REM.Sleep.Behaviour.Disorder</th>
<th align="right">MDS.UPDRS..Subsection.III.V1</th>
<th align="right">diff.MDS.UPRS.III</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Placebo</td>
<td align="left">Male</td>
<td align="right">66</td>
<td align="left">No</td>
<td align="left">No</td>
<td align="right">44</td>
<td align="right">-2</td>
</tr>
<tr class="even">
<td align="left">NR</td>
<td align="left">Female</td>
<td align="right">65</td>
<td align="left">Yes</td>
<td align="left">No</td>
<td align="right">32</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="natural-vs-controlled-or-biased-variates">“Natural” vs controlled or “biased” variates<a class="anchor" aria-label="anchor" href="#natural-vs-controlled-or-biased-variates"></a>
</h3>
<p>For the purpose of drawing scientific inferences, it is extremely
important to be mindful of which variates in the dataset have “natural”
statistics, and which instead have statistics controlled by the observer
– and are therefore “biased”. This distinction is important because the
dataset statistics of the controlled variates may then <em>not</em> be
representative of the naturally-occurring ones, and therefore cannot be
used for inference purposes.</p>
<p>In the present dataset, for instance, the numbers of
<code>Placebo</code> and <code>NR</code> subjects were decided by the
investigators to be in a 50%/50% proportion. Obviously this is not a
naturally occurring proportion; in fact, it does not even make sense of
speaking of a naturally occurring statistics for this
<code>TreatmentGroup</code> variate.</p>
<p>For the <code>Sex</code> variate, the dataset has a proportion of
around 17% <code>Female</code> and 83% <code>Male</code> subjects. This
proportion also partly stems from the selection procedure of the
investigators, so we cannot infer that roughly 16% of Parkinson patients
in the national population are females. It is also possible that the
proportions in the <code>Age</code> variate may depend on the selection
procedure.</p>
<p>On the other hand, the investigators did <em>not</em> choose the
statistics of the two <code>MDS.UPDRS</code> variates, within the groups
having particular values of the other variates. This
<em>conditional</em> or <em>subpopulation</em> statistics can be taken
as representatives of naturally-occurring ones (see <a href="https://doi.org/10.1214/aos/1176345331" class="external-link">Lindley &amp; Novick
(1980)</a> for a brilliant discussion of this point).</p>
<p><em>(add short explanation of exchangeability)</em></p>
</div>
</div>
<div class="section level2">
<h2 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h2>
<p>Let’s load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pglpm/inferno/" class="external-link">inferno</a></span><span class="op">)</span></span></code></pre></div>
<p>In order to draw inferences, we need metadata information, that is,
information about the variates that is <em>not</em> present in the data.
Such information mainly regard the kind and domain of each variate.</p>
<p>As an example of why metadata is necessary, suppose you are given the
data <code>3</code>, <code>7</code>, <code>9</code>. Can you say whether
the value <code>5</code> could be observed in a new instance? and what
about <code>4.7</code>, or <code>-10</code>? Knowing whether these
values are at all possible, or not, greatly affects the precision of the
inferences we draw. Obviously a researcher must know such basic
information about the data being collected – otherwise they wouldn’t
know what they’re doing.</p>
<p>The software requires specification of metadata either as a
<code>data.frame</code> object or as a <code>.csv</code> file. To help
you prepare this file, the software offers the function
<code><a href="../reference/metadatatemplate.html">metadatatemplate()</a></code>, which writes a template that you
thereafter modify. The template is filled with
<strong>tentative</strong> values; these are wild guesses from the data,
so they are often wrong. The function explains the heuristic it is using
in order to pre-fill the fields of the metadata file, and gives warnings
about guessed values that are especially dubious. You should examine and
correct all fields:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/metadatatemplate.html">metadatatemplate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">datafile</span>, file <span class="op">=</span> <span class="st">'temp_metadata'</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analyzing 7 variates for 30 datapoints.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "TreatmentGroup" variate:</span></span>
<span><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span><span class="co">#&gt;  "NR", "Placebo" </span></span>
<span><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "Sex" variate:</span></span>
<span><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span><span class="co">#&gt;  "Female", "Male" </span></span>
<span><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "Age" variate:</span></span>
<span><span class="co">#&gt;   - Numeric values between 29 and 75 </span></span>
<span><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span><span class="co">#&gt;   - All values are positive</span></span>
<span><span class="co">#&gt;   Assuming "domainmin" to be 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "Anamnestic.Loss.of.smell" variate:</span></span>
<span><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span><span class="co">#&gt;  "No", "Yes" </span></span>
<span><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "History.of.REM.Sleep.Behaviour.Disorder" variate:</span></span>
<span><span class="co">#&gt;   -  2 different  values detected:</span></span>
<span><span class="co">#&gt;  "No", "Yes" </span></span>
<span><span class="co">#&gt;   which do not seem to refer to an ordered scale.</span></span>
<span><span class="co">#&gt;   Assuming variate to be NOMINAL.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "MDS.UPDRS..Subsection.III.V1" variate:</span></span>
<span><span class="co">#&gt;   - Numeric values between 15 and 50 </span></span>
<span><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span><span class="co">#&gt;   - All values are positive</span></span>
<span><span class="co">#&gt;   Assuming "domainmin" to be 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "diff.MDS.UPRS.III" variate:</span></span>
<span><span class="co">#&gt;   - Numeric values between -9 and 10 </span></span>
<span><span class="co">#&gt;   Assuming variate to be CONTINUOUS.</span></span>
<span><span class="co">#&gt;   - Distance between datapoints is a multiple of 1 </span></span>
<span><span class="co">#&gt;   Assuming variate to be ROUNDED.</span></span>
<span><span class="co">#&gt; =========</span></span>
<span><span class="co">#&gt; WARNINGS - please make sure to check these variates in the metadata file:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "Age" variate appears to be continuous and rounded,</span></span>
<span><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "MDS.UPDRS..Subsection.III.V1" variate appears to be continuous and rounded,</span></span>
<span><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * "diff.MDS.UPRS.III" variate appears to be continuous and rounded,</span></span>
<span><span class="co">#&gt; but it could also be an ordinal variate</span></span>
<span><span class="co">#&gt; =========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Saved proposal metadata file as "temp_metadata.csv"</span></span></code></pre></div>
<p>We can open the temporary metadata file
<code>temp_metadata.csv</code> and edit it with any software of our
choice. Let’s save the corrected version as
<code>meta_toydata.csv</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadatafile</span> <span class="op">&lt;-</span> <span class="st">'meta_toydata.csv'</span></span></code></pre></div>
<p>The metadata are as follows; <code>NA</code> indicate empty
fields:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="9%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="5%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">type</th>
<th align="right">datastep</th>
<th align="right">domainmin</th>
<th align="right">domainmax</th>
<th align="left">minincluded</th>
<th align="left">maxincluded</th>
<th align="left">V1</th>
<th align="left">V2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TreatmentGroup</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">NR</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Female</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Age</td>
<td align="left">continuous</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Anamnestic.Loss.of.smell</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">History.of.REM.Sleep.Behaviour.Disorder</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">MDS.UPDRS..Subsection.III.V1</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">132</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">diff.MDS.UPRS.III</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">-132</td>
<td align="right">132</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>For a description of the metadata fields, see the help for
<code>metadata</code> with <code><a href="../reference/metadatatemplate.html">?inferno::metadata</a></code>.</p>
<p><em>(More to be written here!)</em></p>
</div>
<div class="section level2">
<h2 id="learning">Learning<a class="anchor" aria-label="anchor" href="#learning"></a>
</h2>
<p>Our inferences will be based on the data already observed, and will
mainly take the form of <em>probabilities</em> about the unkonwn values
various quantities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>,
given the observed values of other quantities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>y</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mi>X</mi><mo>=</mo><mi>x</mi><mo>,</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{Pr}(Y = y \:\vert\: X = x, \mathrm{data})
</annotation></semantics></math> As the notation above indicates,
<em>these probabilities also depend on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><annotation encoding="application/x-tex">\mathrm{data}</annotation></semantics></math>
already observed</em>. They are usually called “posterior
probabilities”.</p>
<p>We need to prepare the software to perform calculations of posterior
probabilities given the observed data. In machine learning an analogous
process is called “learning”. For this reason the function that achieves
this is called <code><a href="../reference/learn.html">learn()</a></code>. It requires at least three
arguments:</p>
<ul>
<li>
<code>data</code>, which can be given as a path to the
<code>csv</code> file containing the data</li>
<li>
<code>metadata</code>, which can also be given as a path to the
metadata file</li>
<li>
<code>outputdir</code>: the name of the directory where the output
should be saved.</li>
</ul>
<p>It may be useful to specify two more arguments:</p>
<ul>
<li>
<code>seed</code>: the seed for the random-number generator, to
ensure reproducibility</li>
<li>
<code>parallel</code>: the number of CPUs to use for the
computation</li>
</ul>
<p>Alternatively you can set the seed with <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>, and
start a set of parallel workers with the
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code> and
<code><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">doParallel::registerDoParallel()</a></code> commands.</p>
<p>The “learning” computation can take tens of minutes, or hours, or
even days depending on the number of variates and data in your inference
problem. The <code><a href="../reference/learn.html">learn()</a></code> function outputs various messages on
how the computation is proceeding. As an example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">learnt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/learn.html">learn</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">datafile</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadatafile</span>,</span>
<span>    outputdir <span class="op">=</span> <span class="st">'parkinson_computations'</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; Registered doParallelSNOW with 12 workers</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Using 30 datapoints</span></span>
<span><span class="co">#&gt; Calculating auxiliary metadata</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; **************************</span></span>
<span><span class="co">#&gt; Saving output in directory</span></span>
<span><span class="co">#&gt; parkinson_computations</span></span>
<span><span class="co">#&gt; **************************</span></span>
<span><span class="co">#&gt; Starting Monte Carlo sampling of 3600 samples by 60 chains</span></span>
<span><span class="co">#&gt; in a space of 703 (effectively 6657) dimensions.</span></span>
<span><span class="co">#&gt; Using 12 cores: 60 samples per chain, 5 chains per core.</span></span>
<span><span class="co">#&gt; Core logs are being saved in individual files.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; C-compiling samplers appropriate to the variates (package Nimble)</span></span>
<span><span class="co">#&gt; this can take tens of minutes with many data or variates.</span></span>
<span><span class="co">#&gt; Please wait...</span></span></code></pre></div>
<p>At the end of the computation the <code><a href="../reference/learn.html">learn()</a></code> function
returns the name of the directory in which the results are saved. In the
code snipped above, this name is saved in the variable
<code>learnt</code>. The object containing the information needed to
make inferences is the <code>learnt.rds</code> file within this
directory.</p>
</div>
<div class="section level2">
<h2 id="drawing-inferences">Drawing inferences<a class="anchor" aria-label="anchor" href="#drawing-inferences"></a>
</h2>
<p>We are finally ready to use the software for drawing inferences,
testing hypotheses, and similar scientific investigations. From the
observed data, the software allows us to find the probability of any
question or hypothesis of interest. It is important, though, that the
hypothesis be stated in an unambiguous, quantitative form.</p>
<div class="section level3">
<h3 id="first-example-effect-on-treated-patient-of-female-sex">First example: effect on treated patient of female sex<a class="anchor" aria-label="anchor" href="#first-example-effect-on-treated-patient-of-female-sex"></a>
</h3>
<p>For example, we might want to ask: “Does the NAD-replenishment
therapy have an effect on females?”. At first this may sound like a
valid scientific hypothesis. But if we carefully examine the statement
we realize that it is too vague. First, what does “having an effect”
mean exactly? how can this be quantified? Second, can we really say that
the therapy either has or has not an effect? are there no degrees of
efficacy involved? Third, whom are we asking this question about? the
next patient that we may see? or the population of all the remaining
patients? Let us make our initial question quantitatively clear.</p>
<p>First, let us translate “effect” into the difference in MDS-UPDRS-III
scores between the first and second visits of a subject
(visit 2 <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>−</mo><annotation encoding="application/x-tex">-</annotation></semantics></math>
visit 1), represented by the variate <code>diff.MDS.UPRS.III</code>.
Note that other choices could be made, such as the difference in another
MDS-UPDRS score (I–IV), or in the total of these scores, or as the ratio
rather than the difference – or as some other variate altogether.</p>
<p>Second, instead of asking the unrealistic dichotomous question “has
or has not?”, we ask how strong the effect is, as quantified by the
value of the MDS-UPDRS-III decrease.</p>
<p>Third, let us ask this question about a possible next patient. We
shall see that this question is also related to the population as a
whole.</p>
<p>We can calculate the probability that, in the next patient, we shall
observe any particular value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
of the MDS-UPDRS-III difference, given that the patient is Female, and
given what has been observed in the clinical trials:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">MDS-UPDRS-III difference</mtext><mo>=</mo><mi>y</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mtext mathvariant="normal">Sex</mtext><mo>=</mo><mtext mathvariant="normal">Female</mtext><mo>,</mo><mtext mathvariant="normal">Treatment group</mtext><mo>=</mo><mtext mathvariant="normal">NR</mtext><mo>,</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{Pr}(\text{MDS-UPDRS-III difference} = y \:\vert\:
\text{Sex} = \text{Female}, \text{Treatment group} = \text{NR}, \mathrm{data})
</annotation></semantics></math></p>
<p>The function for this is <code>Pr(Y, X, learnt)</code>, which accepts
three arguments:</p>
<ul>
<li>
<code>Y</code>: the variates and values of which we want the
probability</li>
<li>
<code>X</code>: the variates and values which are known</li>
<li>
<code>learnt</code>: the knowledge acquired from the dataset</li>
</ul>
<p>Let us first ask this for a specific value of the MDS-UPDRS-III
difference, let’s say <code>0</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probability0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pr.html">Pr</a></span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, TreatmentGroup <span class="op">=</span> <span class="st">'NR'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output of the <code><a href="../reference/Pr.html">Pr()</a></code> function is a list of several
objects, of which we discuss only two for the moment:</p>
<ul>
<li>
<strong><code>value</code></strong>: this is the value of the
probability we wanted to know. In this case it is</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probability0</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y          [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.064202</span></span></code></pre></div>
<p>that is, there is approximately a 6.4% probability that the next
treated female patient will have a MDS-UPDRS-III difference of exactly
0.</p>
<ul>
<li>
<strong><code>quantiles</code></strong>: these values tell us how
much the probability could change, if our knowledge were updated by more
clinical trials. They thus quantify the uncertainty of our present
probabilistic conclusions. A future, updated probability has a 89%
probability of lying between the two extreme (5.5% and 94.5%) quantile
values, and a 50% probability of lying between the middle (25% and 75%)
ones q(these are typical intervals used in the Bayesian literature, see
for instance <a href="https://doi.org/10.21105/joss.01541" class="external-link">Makowski et
al.</a>). In this case they are</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probability0</span><span class="op">$</span><span class="va">quantiles</span></span>
<span><span class="co">#&gt; , ,  = 5.5%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y           [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.0289361</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , ,  = 25%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y           [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.0448123</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , ,  = 75%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y          [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.077569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , ,  = 94.5%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y          [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.111913</span></span></code></pre></div>
<p>that is, if we had many more clinical trials, the probability above
could change to a value within around 2.9% and 11%.</p>
<p><br></p>
<p>We can obviously also ask for the probabilities of all possible
values that the MDS-UPDRS-III difference could have in the next treated
female patient:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pr.html">Pr</a></span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, TreatmentGroup <span class="op">=</span> <span class="st">'NR'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Each probability thus obtained has two accompanying quantiles and
related uncertainty. Both can be visualized with the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>
function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">probabilities</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-13-1.png" alt="plot of chunk unnamed-chunk-13" width="100%"><p class="caption">
plot of chunk unnamed-chunk-13
</p>
</div>
<p>Two aspects of this plot are relevant for our investigation:</p>
<ul>
<li><p>There seems to be slightly more probability mass towards negative
MDS-UPDRS-III differences – which means an improvement in the degree of
disability. We shall quantify this further in a moment.</p></li>
<li><p>However, it is also clear that further clinical trials could lead
to a quite different probability distribution. This is shown by the
breadth of the quantile range.</p></li>
</ul>
<p>Another way to graphically represent and see potential variability of
the result if more trials were available, is to plot some examples – say
100 – of how the results could differ. Such examples are stored in the
third object, <code>samples</code> given by the <code><a href="../reference/Pr.html">Pr()</a></code>
function:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">probabilities</span>, variability <span class="op">=</span> <span class="st">'samples'</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">probabilities</span><span class="op">$</span><span class="va">quantiles</span><span class="op">)</span><span class="op">)</span> <span class="co"># keep same y-range as before</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-14-1.png" alt="plot of chunk unnamed-chunk-14" width="100%"><p class="caption">
plot of chunk unnamed-chunk-14
</p>
</div>
<p><br></p>
<p>Let us ask a more interesting question, which can be a quantitative
counterpart of our initial question “Does the NAD-replenishment therapy
have an effect on females?”. We ask: <em>will the next treated female
patient experience a MDS-UPDRS-III difference equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>
or less?“</em>. We therefore want the probability
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">MDS-UPDRS-III diff.</mtext><mo>≤</mo><mo>−</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mtext mathvariant="normal">Sex</mtext><mo>=</mo><mtext mathvariant="normal">Female</mtext><mo>,</mo><mtext mathvariant="normal">Treatment</mtext><mo>=</mo><mtext mathvariant="normal">NR</mtext><mo>,</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{Pr}(\text{MDS-UPDRS-III diff.} \le -1 \:\vert\:
\text{Sex} = \text{Female}, \text{Treatment} = \text{NR}, \mathrm{data})
</annotation></semantics></math></p>
<p>This probability can be calculated with the function
<code>tailPr(Y, X, learnt)</code>, which is analogous to the
<code><a href="../reference/Pr.html">Pr()</a></code> function, but calculates the probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>≤</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">Y\le y</annotation></semantics></math>
rather than of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">Y = y</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecrease</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, TreatmentGroup <span class="op">=</span> <span class="st">'NR'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The answer is that the probability of a decrease in this disability
score is</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecrease</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y          [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.549769</span></span></code></pre></div>
<p>or approximately 55%; note that it is clearly higher than 50%.</p>
<p>Further clinical trials, however could update this probability to a
new value between 34% and 75%:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecrease</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;     5.5%      25%      75%    94.5% </span></span>
<span><span class="co">#&gt; 0.342894 0.463976 0.641548 0.747442</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="second-example-comparison-with-non-treated-patient-of-female-sex">Second example: comparison with non-treated patient of female
sex<a class="anchor" aria-label="anchor" href="#second-example-comparison-with-non-treated-patient-of-female-sex"></a>
</h3>
<p>In the previous example we found that there is a 55% probability that
a treated female patient will experience a decrease in MDS-UPDRS-III
after the therapy. But can this decrease really be correlated with the
therapy?</p>
<p>To preliminarily answer this question, we can find the analogous
probabilities for a female patient that has not received the treatment.
Again we use <code><a href="../reference/Pr.html">Pr()</a></code>, but our <code>X</code> argument will
specify a <code>Placebo</code> value for the Treatment group:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probabilitiesPlacebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pr.html">Pr</a></span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, TreatmentGroup <span class="op">=</span> <span class="st">'Placebo'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s plot these probabilities, together with their variability (only
the most extreme case), on top of the ones previously obtained for the
treated case:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilities</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'MDS-UPDRS-III difference'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesPlacebo</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilities</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesPlacebo</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add 0-change line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR, Female'</span>, <span class="st">'Placebo, Female'</span><span class="op">)</span>,</span>
<span>    bty <span class="op">=</span> <span class="st">'n'</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-20-1.png" alt="plot of chunk unnamed-chunk-20" width="100%"><p class="caption">
plot of chunk unnamed-chunk-20
</p>
</div>
<p>There does not seem to be any difference that stands out between the
treated and non-treated case.</p>
<p>As before, we can calculate the probability of a decrease in
MDS-UPDRS-III:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecreasePlacebo</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, TreatmentGroup <span class="op">=</span> <span class="st">'Placebo'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We find that the probability of a decrease in the disability score
for a non-treated female patient is</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecreasePlacebo</span><span class="op">$</span><span class="va">value</span></span>
<span><span class="co">#&gt;       X</span></span>
<span><span class="co">#&gt; Y          [,1]</span></span>
<span><span class="co">#&gt;   [1,] 0.543251</span></span></code></pre></div>
<p>or approximately 54%. Further clinical trials, however could update
this probability to a value between 33% and 74%:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecreasePlacebo</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;     5.5%      25%      75%    94.5% </span></span>
<span><span class="co">#&gt; 0.333219 0.453890 0.632558 0.743401</span></span></code></pre></div>
<p>Therefore we see a similarly probable decrease in a non-treated as
well as a non-treated female patient. There is a very small difference
in these two probabilities, in favour of the treated case; but this
difference is too small compared with how the probabilities could change
if more trials were available.</p>
<p>Some preliminary conclusions and possible questions for future
research:</p>
<ul>
<li><p>There does not seem to be a difference between treated and
non-treated female patients, regarding MDS-UPDRS-III decrease.</p></li>
<li><p>However, there <em>is</em> a slightly likely decrease for both.
<strong>What could this decrease be correlated with?</strong></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="third-example-considering-age">Third example: considering age<a class="anchor" aria-label="anchor" href="#third-example-considering-age"></a>
</h3>
<p>Our results so far indicate practically no difference in the
probabilities of MDS-UPDRS-III decrease of a treated vs a non-treated
female patient. These probabilities, however, disregard the patient’s
age. Is it possible that there are larger differences in different age
groups?</p>
<p>We can answer this question by calculating the probabilities
conditional on any particular <code>Age</code> value, that is,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">MDS-UPDRS-III diff.</mtext><mo>≤</mo><mo>−</mo><mn>1</mn><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mtext mathvariant="normal">Sex</mtext><mo>=</mo><mtext mathvariant="normal">Female</mtext><mo>,</mo><mtext mathvariant="normal">Treatment</mtext><mo>=</mo><mtext mathvariant="normal">NR</mtext><mo>,</mo><mtext mathvariant="normal">Age</mtext><mo>=</mo><mi>a</mi><mo>,</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{Pr}(\text{MDS-UPDRS-III diff.} \le -1 \:\vert\:
\text{Sex} = \text{Female}, \text{Treatment} = \text{NR},
\text{Age} = a, \mathrm{data})
</annotation></semantics></math> for meaningful values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
of the age, let’s say between 25 and 80. Again we can find them with the
function <code>tailPr()</code>. This time our conditioning argument
<code>X</code> will include a grid of <code>Age</code> values. First we
do the calculation for a treated female patient, then for a non-treated
one:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probDecreaseAge</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, Age <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, TreatmentGroup <span class="op">=</span> <span class="st">'NR'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probDecreaseAgePlacebo</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Female'</span>, Age <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, TreatmentGroup <span class="op">=</span> <span class="st">'Placebo'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can plot the probabilities of an MDS-UPDRS-III decrease against
that patient’s age, with one plot for each treatment group:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAge</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'age'</span>, ylab <span class="op">=</span> <span class="st">'probability of MDS-UPDRS-III decr.'</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAgePlacebo</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAge</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>, col <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAgePlacebo</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add 50%-probability line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.5</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR, Female'</span>, <span class="st">'Placebo, Female'</span><span class="op">)</span>,</span>
<span>    bty <span class="op">=</span> <span class="st">'n'</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-25-1.png" alt="plot of chunk unnamed-chunk-25" width="100%"><p class="caption">
plot of chunk unnamed-chunk-25
</p>
</div>
<p>This plot shows some interesting aspects:</p>
<ul>
<li><p>There does not seem to be a large difference, between treated and
non-treated females, in the probability of a MDS-UPDRS-III
decrease.</p></li>
<li><p>In the 60–65 age group, an <em>increase</em> in MDS-UPDRS-III is
more likely than a decrease, for both a treated and a non-treated female
patient. <strong>What could be the reason for the increase in this
narrow age group?</strong></p></li>
</ul>
<p>Again notice that these probabilities could be updated to very
different values, if more clinical trials were available.</p>
</div>
<div class="section level3">
<h3 id="fourth-example-male-patient">Fourth example: male patient<a class="anchor" aria-label="anchor" href="#fourth-example-male-patient"></a>
</h3>
<p>We can perform an analysis analogous to the previous examples, but
for a male patient. Here are the corresponding function calls and
plots.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probabilitiesMale</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Pr.html">Pr</a></span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Male'</span>, TreatmentGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR'</span>, <span class="st">'Placebo'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesMale</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'MDS-UPDRS-III difference'</span>, ylab <span class="op">=</span> <span class="st">'probability'</span>, col <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesMale</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span>,<span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">6</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesMale</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">7</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="op">-</span><span class="fl">30</span><span class="op">)</span><span class="op">:</span><span class="fl">30</span>, y <span class="op">=</span> <span class="va">probabilitiesMale</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">6</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add 0-change line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR, Male'</span>, <span class="st">'Placebo, Male'</span><span class="op">)</span>,</span>
<span>    bty <span class="op">=</span> <span class="st">'n'</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-26-1.png" alt="plot of chunk unnamed-chunk-26" width="100%"><p class="caption">
plot of chunk unnamed-chunk-26
</p>
</div>
<p>And considering all ages separately:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probMaleDecreaseAge</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Male'</span>, Age <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, TreatmentGroup <span class="op">=</span> <span class="st">'NR'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">probMaleDecreaseAgePlacebo</span> <span class="op">&lt;-</span> <span class="fu">tailPr</span><span class="op">(</span></span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>diff.MDS.UPRS.III <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sex <span class="op">=</span> <span class="st">'Male'</span>, Age <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, TreatmentGroup <span class="op">=</span> <span class="st">'Placebo'</span><span class="op">)</span>,</span>
<span>    learnt <span class="op">=</span> <span class="va">learnt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAge</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'age'</span>, ylab <span class="op">=</span> <span class="st">'probability of MDS-UPDRS-III decr.'</span>, col <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAgePlacebo</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">6</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAge</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">7</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAgePlacebo</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">6</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add 50%-probability line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.5</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR, Male'</span>, <span class="st">'Placebo, Male'</span><span class="op">)</span>,</span>
<span>    bty <span class="op">=</span> <span class="st">'n'</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-27-1.png" alt="plot of chunk unnamed-chunk-27" width="100%"><p class="caption">
plot of chunk unnamed-chunk-27
</p>
</div>
<p>Finally let’s compare treated female vs male patients, per age:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAge</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'age'</span>, ylab <span class="op">=</span> <span class="st">'probability of MDS-UPDRS-III decr.'</span>, col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotquantiles.html">plotquantiles</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAge</span><span class="op">$</span><span class="va">quantiles</span><span class="op">[</span><span class="fl">1</span>,, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5.5%'</span>, <span class="st">'94.5%'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">7</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probDecreaseAge</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/flexiplot.html">flexiplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">25</span><span class="op">:</span><span class="fl">80</span>, y <span class="op">=</span> <span class="va">probMaleDecreaseAge</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,</span>
<span>    col <span class="op">=</span> <span class="fl">7</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add 50%-probability line</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.5</span>, lwd <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topright'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'NR, Female'</span>, <span class="st">'NR, Male'</span><span class="op">)</span>,</span>
<span>    bty <span class="op">=</span> <span class="st">'n'</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figure/unnamed-chunk-28-1.png" alt="plot of chunk unnamed-chunk-28" width="100%"><p class="caption">
plot of chunk unnamed-chunk-28
</p>
</div>
<p><em>(TO BE CONTINUED)</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by PierGianLuca Porta Mana, Aurora Grefsrud, Håkon Mydland, Maksim Ohvrill, Simen Hesthamar Hauge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
