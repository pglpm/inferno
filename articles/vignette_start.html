<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example of use: inferno for penguins • inferno</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example of use: inferno for penguins">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">inferno</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette_mutualinfo.html">Associations of variates with mutual information</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_parkinson.html">Example of use: inferences for Parkinson's Disease</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_start.html">Example of use: inferno for penguins</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pglpm/inferno/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example of use: inferno for penguins</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pglpm/inferno/blob/main/vignettes/vignette_start.Rmd" class="external-link"><code>vignettes/vignette_start.Rmd</code></a></small>
      <div class="d-none name"><code>vignette_start.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-crash-course-in-population-inference">A crash course in population inference<a class="anchor" aria-label="anchor" href="#a-crash-course-in-population-inference"></a>
</h2>
<p>A very common type of inference is the following. We have a large or
potentially infinite group of entities, each having a set of
characteristics. Having checked the characteristics of several entities
from this group, we want to make guesses about the characteristics of
new entities from the same group.</p>
<p>The description just given is very generic or even vague. Indeed it
can be applied to a huge variety of situations.</p>
<ul>
<li>The ‘entities’ could be: objects, like electronic components; or
people, or animals, or plants, or events of some kind.</li>
<li>The characteristics could be: the material the object is made of,
and the result of some test made on it; or the age, blood-test results,
and disease condition of the person; or the species and body mass of the
animal; or the length of the petals of the flower.</li>
<li>The group could be: electronic components coming out of a particular
production line; or people of a given nationality and with given
symptoms; or animals from a particular island; or flowers of a specific
genus or family.</li>
</ul>
<p>The possibilities are endless.</p>
<p>Also the kinds of guesses that we want to make can be very diverse.
We might want to guess all characteristics of a new entity; or, having
checked <em>some</em> characteristics of a new entity, we want to guess
the ones that we haven’t or can’t check. Important examples of this kind
of inference appear in medicine. For example we may have a group defined
as follows:</p>
<ul>
<li>
<em>Group</em>: people from a given nationality, suffering from one
of two possible diseases.</li>
</ul>
<p>And we may consider these characteristics:</p>
<ul>
<li>
<em>Characteristics</em>: age; sex; weight; presence or absence of a
particular genetic factor; symptoms from a specific set of possible
ones; kind of disease.</li>
</ul>
<p>We observed as many as possible of these characteristics in a sample
of people from this group. Now a new person from the same group appears
in front of us. We check this person’s age, sex, weight, symptoms. We
need to guess which of the two diseases affects this person.</p>
<p><br>
Having discussed these simple examples, let’s agree on some more
standard terminology. Let’s call:</p>
<ul>
<li>
<strong>Population</strong>: what we’ve called ‘group’.</li>
<li>
<strong>Unit</strong>: what we’ve called ‘entity’ – the object,
person, animal, etc.</li>
<li>
<strong>Variate</strong>: what we’ve called ‘characteristic’.</li>
</ul>
<p><br></p>
<p><a href="https://doi.org/10.1016/j.cmet.2022.02.001" class="external-link">Brakedal &amp;
al. (2022)</a>, which generously and professionally shares its <a href="https://www.cell.com/cms/10.1016/j.cmet.2022.02.001/attachment/82e51142-50b8-4f84-a3e0-7c08d641a47b/mmc2.xlsx" class="external-link">data</a>.</p>
<ul>
<li><p><strong>Treatment group</strong>: <em>Binary</em> variate with
values <code>Placebo</code> and <code>NR</code>.</p></li>
<li><p><strong>Sex</strong>: <em>Binary</em> variate with values
<code>Female</code> and <code>Male</code>.</p></li>
</ul>
<p>We store the name of the datafile</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="va">penguins</span></span></code></pre></div>
<p>Here are the values for two subjects:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="14%">
<col width="12%">
<col width="12%">
<col width="17%">
<col width="14%">
<col width="10%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">species</th>
<th align="left">island</th>
<th align="right">bill_len</th>
<th align="right">bill_dep</th>
<th align="right">flipper_len</th>
<th align="right">body_mass</th>
<th align="left">sex</th>
<th align="right">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie</td>
<td align="left">Torgersen</td>
<td align="right">39.1</td>
<td align="right">18.7</td>
<td align="right">181</td>
<td align="right">3750</td>
<td align="left">male</td>
<td align="right">2007</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="left">Torgersen</td>
<td align="right">39.5</td>
<td align="right">17.4</td>
<td align="right">186</td>
<td align="right">3800</td>
<td align="left">female</td>
<td align="right">2007</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="left">Torgersen</td>
<td align="right">40.3</td>
<td align="right">18.0</td>
<td align="right">195</td>
<td align="right">3250</td>
<td align="left">female</td>
<td align="right">2007</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="left">Torgersen</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="right">2007</td>
</tr>
<tr class="odd">
<td align="left">Adelie</td>
<td align="left">Torgersen</td>
<td align="right">36.7</td>
<td align="right">19.3</td>
<td align="right">193</td>
<td align="right">3450</td>
<td align="left">female</td>
<td align="right">2007</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="natural-vs-controlled-or-biased-variates">“Natural” vs controlled or “biased” variates<a class="anchor" aria-label="anchor" href="#natural-vs-controlled-or-biased-variates"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="metadata">Metadata<a class="anchor" aria-label="anchor" href="#metadata"></a>
</h2>
<p>Let’s load the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pglpm/inferno/" class="external-link">inferno</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## metadatatemplate(data = datafile, file = 'temp_metadata')</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadatafile</span> <span class="op">&lt;-</span> <span class="st">'meta_toydata.csv'</span></span></code></pre></div>
<p>The metadata are as follows; <code>NA</code> indicate empty
fields:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="9%">
<col width="7%">
<col width="8%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="5%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">type</th>
<th align="right">datastep</th>
<th align="right">domainmin</th>
<th align="right">domainmax</th>
<th align="left">minincluded</th>
<th align="left">maxincluded</th>
<th align="left">V1</th>
<th align="left">V2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TreatmentGroup</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">NR</td>
<td align="left">Placebo</td>
</tr>
<tr class="even">
<td align="left">Sex</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">Female</td>
<td align="left">Male</td>
</tr>
<tr class="odd">
<td align="left">Age</td>
<td align="left">continuous</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Anamnestic.Loss.of.smell</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">History.of.REM.Sleep.Behaviour.Disorder</td>
<td align="left">nominal</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">No</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">MDS.UPDRS..Subsection.III.V1</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">132</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">diff.MDS.UPRS.III</td>
<td align="left">ordinal</td>
<td align="right">1</td>
<td align="right">-132</td>
<td align="right">132</td>
<td align="left">yes</td>
<td align="left">yes</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p><em>(More to be written here!)</em></p>
</div>
<div class="section level2">
<h2 id="learning">Learning<a class="anchor" aria-label="anchor" href="#learning"></a>
</h2>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mi>y</mi><mspace width="0.222em"></mspace><mo stretchy="false" form="postfix">|</mo><mspace width="0.222em"></mspace><mi>X</mi><mo>=</mo><mi>x</mi><mo>,</mo><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathrm{Pr}(Y = y \:\vert\: X = x, \mathrm{data})
</annotation></semantics></math> As the notation above indicates,
<em>these probabilities also depend on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">a</mi></mrow><annotation encoding="application/x-tex">\mathrm{data}</annotation></semantics></math>
already observed</em>. They are usually called “posterior
probabilities”.</p>
<p>We need to prepare the software to perform calculations of posterior
probabilities given the observed data. In machine learning an analogous
process is called “learning”. For this reason the function that achieves
this is called <code><a href="../reference/learn.html">learn()</a></code>. It requires at least three
arguments:</p>
<ul>
<li>
<code>data</code>, which can be given as a path to the
<code>csv</code> file containing the data</li>
<li>
<code>metadata</code>, which can also be given as a path to the
metadata file</li>
<li>
<code>outputdir</code>: the name of the directory where the output
should be saved.</li>
</ul>
<p>It may be useful to specify two more arguments:</p>
<ul>
<li>
<code>seed</code>: the seed for the random-number generator, to
ensure reproducibility</li>
<li>
<code>parallel</code>: the number of CPUs to use for the
computation</li>
</ul>
<p>Alternatively you can set the seed with <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>, and
start a set of parallel workers with the
<code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code> and
<code><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">doParallel::registerDoParallel()</a></code> commands.</p>
<p>The “learning” computation can take tens of minutes, or hours, or
even days depending on the number of variates and data in your inference
problem. The <code><a href="../reference/learn.html">learn()</a></code> function outputs various messages on
how the computation is proceeding. As an example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">learnt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/learn.html">learn</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">datafile</span>,</span>
<span>    metadata <span class="op">=</span> <span class="va">metadatafile</span>,</span>
<span>    outputdir <span class="op">=</span> <span class="st">'parkinson_computations'</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    parallel <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#&gt; Registered doParallelSNOW with 12 workers</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Using 30 datapoints</span></span>
<span><span class="co">#&gt; Calculating auxiliary metadata</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; **************************</span></span>
<span><span class="co">#&gt; Saving output in directory</span></span>
<span><span class="co">#&gt; parkinson_computations</span></span>
<span><span class="co">#&gt; **************************</span></span>
<span><span class="co">#&gt; Starting Monte Carlo sampling of 3600 samples by 60 chains</span></span>
<span><span class="co">#&gt; in a space of 703 (effectively 6657) dimensions.</span></span>
<span><span class="co">#&gt; Using 12 cores: 60 samples per chain, 5 chains per core.</span></span>
<span><span class="co">#&gt; Core logs are being saved in individual files.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; C-compiling samplers appropriate to the variates (package Nimble)</span></span>
<span><span class="co">#&gt; this can take tens of minutes with many data or variates.</span></span>
<span><span class="co">#&gt; Please wait...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="drawing-inferences">Drawing inferences<a class="anchor" aria-label="anchor" href="#drawing-inferences"></a>
</h2>
<p><em>(TO BE CONTINUED)</em></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by PierGianLuca Porta Mana, Aurora Grefsrud, Håkon Mydland, Simen Hesthamar Hauge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
